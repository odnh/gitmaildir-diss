%TC:ignore
\documentclass[12pt,a4paper,twoside,openright]{report}
\usepackage[pdfborder={0 0 0}]{hyperref}    % turns references into hyperlinks
\usepackage[margin=25mm]{geometry}  % adjusts page layout
\usepackage{graphicx}  % allows inclusion of PDF, PNG and JPG images
\usepackage{tikz}      % fancy diagrams
\usepackage{dirtree}   % for directory tree
\usepackage{booktabs}  % for nicer tables
\usepackage{verbatim}
\usepackage{pdfpages}  % include api_docs in appendix
\usepackage{makecell}  % for overfull title table cell in proforma
\usepackage{adjustbox} % for the proforma table (resizes to get rid of latex warnings)
\usepackage{minted}    % code highlighting
\usepackage{enumitem}  % modify enum environments easily
\usepackage[algoruled]{algorithm2e} % for algorithm typesetting
\usepackage[backend=biber,style=numeric]{biblatex}
\addbibresource{refs.bib}
\usepackage{docmute}   % only needed to allow inclusion of proposal.tex

\raggedbottom                           % try to avoid widows and orphans
\sloppy
\clubpenalty1000%
\widowpenalty1000%

\renewcommand{\baselinestretch}{1.1}    % adjust line spacing to make
                                        % more readable

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title

\thispagestyle{empty}

\rightline{\LARGE \textbf{Oliver Hope}}

\begin{tikzpicture}[remember picture,overlay]
   \node[anchor=south,inner sep=60pt] at (current page.south)
   {\includegraphics[scale=0.4]{figs/cu_logo}};
\end{tikzpicture}

\vspace*{60mm}
\begin{center}
\Huge
\textbf{A strongly consistent index for email using Git and MirageOS.} \\[5mm]
Computer Science Tripos -- Part II \\[5mm]
Jesus College \\[5mm]
\today  % today's date
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Declaration, Proforma, table of contents and list of figures

\pagestyle{plain}

\newpage

\pagenumbering{roman}
\setcounter{page}{1}

\section*{Declaration}

I, Oliver Hope of Jesus College, being a candidate for Part II of the Computer Science Tripos, hereby declare that this dissertation and the work described in it are my own work, unaided except as may be specified below, and that the dissertation does not contain material that has already been used to any substantial extent for a comparable purpose.
\\*
\\*
I, Oliver Hope of Jesus College,
am content for my dissertation to be made available to the students and staff of the University.

\bigskip
\leftline{Signed}

\medskip
\leftline{Date}

\chapter*{Proforma}

\begin{adjustbox}{width={\textwidth},totalheight={\textheight},keepaspectratio}%
{\large
\begin{tabular}{ll}
Candidate Number:   & \bf 2329F \\
Project Title:      & \makecell[l]{\bf A strongly consistent index for email using Git \\ \bf and MirageOS.} \\
Examination:        & \bf Computer Science Tripos -- Part II, June 2019 \\
Word Count:         & \bf \input{|"texcount -inc -sum -1 diss.tex"}\footnotemark[1] \\
Line Count:         & 1925\footnotemark[2] \\
Project Originator: & Dr A.~Madhavapeddy \\
Supervisor:         & Mr D.~Allsopp \\
\end{tabular}
}
\end{adjustbox}
\footnotetext[1]{This word count was computed by \texttt{texcount -inc -sum -1 diss.tex}}
\footnotetext[2]{Line count is count of OCaml code excluding comments and blank lines. Also excluded are all testing scripts}

\stepcounter{footnote}


\section*{Original Aims of the Project}

The original aims of the project were to create a new type of maildir on top of a git store. This was to provide the consistency that maildir does not afford whilst mitigating some of the problems with mbox that inspired the creation of maildir in the first place. Futhermore using git for mail storage allows for many novel features that can be implemented, and some examples of such features were a further aim.

\section*{Work Completed}

The core of the project built was a library, gitmaildir, which handles interaction with a gitmaildir. Then there are also two helper tools: \texttt{gitmaildir\_cli} a command-line interface for gitmaildirs and \texttt{gitmaildir\_daemon}, a daemon to sync a gitmaildir with a standard maildir. Also two extensions have been completed: branching based on reply threads and branching for preprocessing of mail for different devices. Of course as part of this it was necessary to design how a gitmaildir would work and write some code to create metrics for performance testing.

\section*{Special Difficulties}

There have been no special difficulties.

\newpage

\tableofcontents

\listoffigures

\newpage
%TC:endignore
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% now for the chapters

\pagenumbering{arabic}
\setcounter{page}{1}

\pagestyle{headings}

\include{introduction}

\include{preparation}

\include{implementation}

\include{evaluation}

\include{conclusions}

%TC:ignore
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% the bibliography
\addcontentsline{toc}{chapter}{Bibliography}
\printbibliography

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% the appendices
\appendix

\chapter{Git\_ops module API documentation} \label{section:docs}
\includepdf[scale=0.9,page=1-,pagecommand={\thispagestyle{headings}}]{figs/api_docs}

\chapter{Timing script sample} \label{section:bashtiming}

\input{timing_script}

\chapter{Project Proposal}

\input{proposal}

\end{document}
%TC:endignore
