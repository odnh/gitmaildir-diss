\chapter{Introduction}

\section{Motivation}

Email is a system of electronic communication supported by most personal computing platforms. It has been in use since the very beginnings of the Internet\footnote{This can be seen from an RFC for mailbox protocols being published in 1971\cite{rfc196}}. An important part of this system is the ability to store messages. Storage is needed both for end users for later reading and on servers while emails await delivery. Over time there have been multiple different formats for email storage in mailboxes, one of the earliest and most widely used standards being Mbox. Another standard that was created later to deal with some of the shortcomings of Mbox was Maildir.

The important difference between Mbox and Maildir is that Mbox relies on the entire mailbox being stored in a single file whereas Maildir keeps each email as a separate file in a directory. This makes Mbox very simple and places a strict ordering on the emails stored but this does mean that only one process can read or write an Mbox at once. However, for Maildir we have concurrency for reads and writes but we lose the ordering that Mbox provided. This project seeks to find a middle ground where we can maintain some of the benefits that Maildir has such as concurrency whilst not losing the ability to have a consistent view of stored emails which Mbox offered.

\section{Project goals}

It would be useful to have an implementation of a mailbox format which is both concurrent and scalable whilst also having the ability to have a consistent view of the stored emails.

Git is a distributed version control system which will be introduced in more detail in the preparation section. The project aims to solve the above problem by combining a Git layer with Maildir format to provide strong consistency. Furthermore, the intent is that the basic features should be able to function both on MirageOS and a standard Unix system (such as Linux), and that the use of Git will allow for the implementation of extra features that let us use and interact with a mailbox in new ways.

\section{Summary of work}

During the project I completed an OCaml library to provide the functionality of a Maildir with a Git overlay. Alongside this I created command-line applications to use and provide a demonstration of its functionality and also implemented two extensions in the form of a daemon that synchronises a Maildir with the Git version and a system to create a separate repository of plain text emails for use in low bandwidth situations.

In undertaking this there were a few challenges. These were mainly related to learning to use OCaml correctly and in finding libraries to use to provide functionality. As I was following an iterative development process, there were points where a misunderstanding or incorrect assumption earlier on lead to a point where the next feature could not be implemented correctly or a library did not provide quite the correct functionality. However, this was to be expected and so informed the next stage of development and so did not inversely impact the end result (as can be seen in the evaluation)

The code was evaluated through testing of functionality and performance. The functionality tests (unit testing was used) showed that the library functioned correctly as intended. The performance tests showed that in some cases the performance of the Git Maildir was similar to that of the Maildir and superior to the Mbox but that there were also cases where the performance was more similar to the Mbox and underperformed against both existing standards. This is a success as it was in line with my expectations for performance.
